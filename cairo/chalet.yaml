name: ofLibs
version: "1.0"

externalDependencies:
  cairo:
    repository: https://gitlab.freedesktop.org/cairo/cairo
    # tag: 1.18.4
    commit: 200a02286bfe9a39839b9fc8d715b852ccf25d71
    kind: git
targets:
  cairo:
    kind: mesonProject
    location: ${external:${name}}
    install: true
    defines:
      - buildtype=release
      - default_library=static

      - pixman:default_library=static

      # Disable tests
      - tests=disabled

      # Disable X11 backends
      - xcb=disabled
      - xlib=disabled

      # Disable compression
      - lzo=disabled
      # zlib is required for PDF support

      # Disable font/text backends
      - dwrite=disabled
      - fontconfig=disabled
      - freetype=disabled

      # Disable GObject introspection and bindings
      - glib=disabled

      # Disable utilities
      - gtk2-utils=disabled
      - symbol-lookup=disabled

      # Disable image formats you don't need
      # png is required for SVG support

      # Disable additional features
      - tee=disabled
      - spectre=disabled

    defines[toolchain:{aarch64-linux-gnu-gcc,arm-linux-gnueabihf-gcc}]:
      - pixman:mmx=disabled
      - pixman:sse2=disabled
      - pixman:ssse3=disabled
      - pixman:vmx=disabled

    defines[platform:macos]:
      - c_args=-mmacos-version-min=10.15
      - cpp_args=-mmacos-version-min=10.15

distribution:
  cairo:
    kind: archive
    format: zip
    include:
      - ${external:${name}}/COPYING*
      - ${externalBuild:${name}}/install/include
      - ${externalBuild:${name}}/install/lib
